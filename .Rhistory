source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
Defaults <- read.xlsx("https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", sheet = "T6.2.3.1")
library(xlsx)
Defaults <- read.xlsx("https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", sheet = "T6.2.3.1")
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", destfile = "PrimeDeRisque/Defaults_OFS.xlsx", mode="wb")
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", destfile = "./PrimeDeRisque/Defaults_OFS.xlsx", mode="wb")
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", mode="wb")
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", destfile = "./PrimeDeRisque/Defaults_OFS.xlsx", mode="wb")
#-------------------------------------------------------------------------------------
# Compute risk premia
#-------------------------------------------------------------------------------------
download.file(url = "https://www.bfs.admin.ch/bfsstatic/dam/assets/7966853/master", destfile = "./PrimeDeRisque/Defaults_OFS.xlsx", mode="wb")
download.file(url = "https://www.six-group.com/exchanges/downloads/indexdata/hsb_maturity_gov_y.csv", destfile = "./PrimeDeRisque/ObligationsConf.csv", mode="wb")
download.file(url = "https://www.six-group.com/exchanges/downloads/indexdata/hsb_maturity_dom_non_gov_rating_sbi_y.csv", destfile = "./PrimeDeRisque/ObligationsEnt.csv", mode="wb")
Gov      <- read.csv("./PrimeDeRisque/ObligationsConf.csv", sep = ";", skip = 4)
NonGov   <- read.csv("./PrimeDeRisque/ObligationsEnt.csv", sep = ";", skip = 4)
Defaults <- read.xlsx("./PrimeDeRisque/Defaults_OFS.xlsx", sheet = "T6.2.3.1")
Defaults <- read.xlsx("./PrimeDeRisque/Defaults_OFS.xlsx", sheetName = "T6.2.3.1")
Defaults
Defaults[2, -1]
Defaults[1, -1]
# Beginning of default procedures (Ouverture des procédures de faillite)
Faillite <- xts(Defaults[2, -1], order.by = paste(Defaults[1, -1], "-01-01", sep = ""))
# Beginning of default procedures (Ouverture des procédures de faillite)
Faillite <- xts(Defaults[2, -1], order.by = as.Date(paste(Defaults[1, -1], "-01-01", sep = "")))
as.Date(paste(Defaults[1, -1], "-01-01", sep = ""))
Defaults[1, -1]
paste(Defaults[1, -1], "-01-01", sep = "")
# Beginning of default procedures (Ouverture des procédures de faillite)
Faillite <- xts(Defaults[2, -1], order.by = as.Date(paste(as.numeric(Defaults[1, -1]), "-01-01", sep = "")))
paste(as.numeric(Defaults[1, -1]), "-01-01", sep = "")
Defaults <- read.xlsx("./PrimeDeRisque/Defaults_OFS.xlsx", sheetName = "T6.2.3.1")
Defaults
? read.xlsx
Defaults <- read.xlsx("./PrimeDeRisque/Defaults_OFS.xlsx", sheetName = "T6.2.3.1", as.data.frame = TRUE)
Defaults
# Beginning of default procedures (Ouverture des procédures de faillite)
Faillite <- xts(Defaults[2, -1], order.by = as.Date(paste(as.numeric(Defaults[1, -1]), "-01-01", sep = "")))
as.Date(paste(as.numeric(Defaults[1, -1]), "-01-01", sep = ""))
as.Date(paste(as.numeric(Defaults[1, -1]), "-01-01", sep = ""))Defaults[1, -1])
Defaults[1, -1]
as.numeric(Defaults[1, -1])
as.numeric(Defaults[1,])
(Defaults[1,])
(Defaults[1,2:length(Defaults[1,2:])])
(Defaults[1,2:length(Defaults[1,])])
as.numeric((Defaults[1,2:length(Defaults[1,])]))
as.matrix((Defaults[1,2:length(Defaults[1,])]))
as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])])))
# Beginning of default procedures (Ouverture des procédures de faillite)
myDate   <- paste(as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])]))), "-01-01", sep = ""))
# Beginning of default procedures (Ouverture des procédures de faillite)
myDate   <- paste(as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])]))), "-01-01", sep = "")
as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])])))myDate
myDate
Faillite <- xts(Defaults[2, -1], order.by = myDate)
# Beginning of default procedures (Ouverture des procédures de faillite)
myDate   <- as.Date(paste(as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])]))), "-01-01", sep = ""))
Faillite <- xts(Defaults[2, -1], order.by = myDate)
Defaults[2, -1]
myDefaults  <- as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])]))
)
myDefaults
myDefaults  <- as.numeric(as.matrix((Defaults[2,2:length(Defaults[2,])])))
Faillite <- xts(Defaults[2, -1], order.by = myDate)
# Beginning of default procedures (Ouverture des procédures de faillite)
myDate      <- as.Date(paste(as.numeric(as.matrix((Defaults[1,2:length(Defaults[1,])]))), "-01-01", sep = ""))
myDefaults  <- as.numeric(as.matrix((Defaults[2,2:length(Defaults[2,])])))
Faillite <- xts(Defaults[2, -1], order.by = myDate)
myDefaults
length(myDefaults)
length(myDate)
Faillite <- xts(myDefaults, order.by = myDate)
Faillite
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
RPBBB10[1]
RPBBB1[1]
RPAA1[1]
RPAA3[1]
RPAA7[1]
BBB1[1]
BBB1[2]
AA1[1]
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
p <- ts_ggplot(
`Confédération`                     = ts_span(Gov1, startDate),
`Entrerpises (notation AA-AAA)`     = ts_span(AA1, startDate),
`Entrerpises (notation BBB-AAA)`    = ts_span(BBB1, startDate),
title = "Rendements des obligations à 1 ans (en %)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("black",  "#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = -2.0, label="Faillite de Lehman Brothers", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = -2.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = -2.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/Obligations.png", width = 5, height = 4)
ggsave(filename = "./PrimeDeRisque/Obligations.png", width = 5, height = 4)
ggsave(filename = "./PrimeDeRisque/Obligations.png", width = 5, height = 4)
warnings()
p <- ts_ggplot(
`Confédération`                     = ts_span(Gov1, startDate),
`Entrerpises (notation AA-AAA)`     = ts_span(AA1, startDate),
`Entrerpises (notation BBB-AAA)`    = ts_span(BBB1, startDate),
title = "Rendements des obligations à 1 ans (en %)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("black",  "#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 0, label="Faillite de Lehman Brothers", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 2, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 2, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/Obligations.png", width = 5, height = 4)
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
p <- ts_ggplot(
`Entrerpises (notation AA-AAA)`  = ts_span(RPAA1, startDate),
`Entrerpises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Primes de risque à 1 ans (en pp)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/PrimesDeRisque.png", width = 5, height = 4)
p <- ts_ggplot(
`Primes de risques (notation AA-AAA, en pp)`           = ts_span(RPAA1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = -2.0, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = -2.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = -2.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/ProcFaillitePrime.png", width = 5, height = 4)
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 2, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 2, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 2, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/ProcFaillitePrime.png", width = 5, height = 4)
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/ProcFaillitePrime.png", width = 5, height = 4)
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
Faillite <- ts_pc(xts(myDefaults, order.by = myDate)/numberFirms2017)/10
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
Faillite <- ts_diff(xts(myDefaults, order.by = myDate)/numberFirms2017)
Faillite
Faillite <- ts_diff(xts(myDefaults, order.by = myDate)/numberFirms2017)*100
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
Faillite <- ts_diff(xts(myDefaults, order.by = myDate)/numberFirms2017)*100
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
Faillite <- ts_diff(xts(myDefaults, order.by = myDate)/1000)*100
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
Faillite <- ts_diff(xts(myDefaults, order.by = myDate)/1000)
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (en % des ent. en 2017)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = -0.5, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = -0.5, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = -0.5, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank())
p
p <- ts_ggplot(
`Primes de risques (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures)`  = ts_span(Faillite, startDate),
title = "Relation avec les procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "#D95F02"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank())
p
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
#-------------------------------------------------------------------------------------
# Create charts
#-------------------------------------------------------------------------------------
myLines <- c(as.numeric(as.Date("2008-09-15")), as.numeric(as.Date("2015-01-15")), as.numeric(as.Date("2020-02-01")))
p <- ts_ggplot(
`Confédération`                     = ts_span(Gov1, startDate),
`Entreprises (notation BBB-AAA)`    = ts_span(BBB1, startDate),
title = "Rendements des obligations à 1 ans (en %)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "red"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank())
p
ggsave(filename = "./PrimeDeRisque/Obligations.png", width = 5, height = 4)
p <- ts_ggplot(
`Entreprises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Prime de risque à 1 ans (en pp)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("red"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
ggsave(filename = "./PrimeDeRisque/PrimesDeRisque.png", width = 5, height = 4)
p <- ts_ggplot(
`Prime de risque (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures par an)`  = ts_span(Faillite, startDate),
title = "Relation avec des procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "red"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank())
p
ggsave(filename = "./PrimeDeRisque/ProcFaillitePrime.png", width = 5, height = 4)
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
p <- ts_ggplot(
`Entreprises (notation AA-AAA)` = ts_span(RPAAA1, startDate),
`Entreprises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Prime de risque à 1 ans (en pp)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("black"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.3, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Entreprises (notation AA-AAA)` = ts_span(RPAAA1, startDate),
`Entreprises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Prime de risque à 1 ans (en pp)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.3, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Entreprises (notation AA-AAA)` = ts_span(RPAAA1, startDate),
`Entreprises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Prime de risque à 1 ans (en pp)"
)
RPAAA1 <- AAA1 - Gov1
RPAAA1 <- AA1 - Gov1
p <- ts_ggplot(
`Entreprises (notation AA-AAA)` = ts_span(RPAAA1, startDate),
`Entreprises (notation BBB-AAA)` = ts_span(RPBBB1, startDate),
title = "Prime de risque à 1 ans (en pp)"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank()) +
geom_vline(xintercept=myLines , colour="blue", size = 1, alpha = 0.5)
p <- p+  geom_text(x =myLines[1], y = 1.3, label="Faillite Lehman", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[2], y = 1, label="Fin du taux plancher", colour="blue", angle=90, vjust = -1)
p <- p+  geom_text(x =myLines[3], y = 1, label="Crise Corona", colour="blue", angle=90, vjust = -1)
p
p <- ts_ggplot(
`Prime de risque (notation AA-AAA)` = ts_span(RPAAA1, startDate),
`Prime de risque (notation BBB-AAA, en pp)`           = ts_span(RPBBB1, startDate),
`Ouverture proc. de faillite (variation, en 1000 ouvertures par an)`  = ts_span(Faillite, startDate),
title = "Relation avec des procédures de faillite"
)
p <- p + theme_minimal() + ylab("")+xlab("")+
ggplot2::geom_line(aes(),size=1)+ggplot2::scale_color_brewer(palette = "Dark2")+
scale_color_manual(values = c("#1B9E77", "black"))+
theme(legend.position="bottom",legend.margin=margin(0,0,0,0),legend.box.margin=margin(-20,-5,0,-5))+ggplot2::guides(col=guide_legend(nrow=2,byrow=TRUE))+ggplot2::theme(legend.title = element_blank())+
theme(axis.line = element_line(colour = "black", size = 0.1))+ theme(panel.background = element_blank())+
theme(panel.border = element_rect(linetype = "solid", colour = "black", fill = NA))+theme(text = element_text(family = "Palatino"))+
theme(panel.grid.major = element_line(colour = "black",size=0.1,linetype="dotted"), panel.grid.minor = element_blank())
p
display.brewer.pal(n = 8, name = 'Dark2')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
source('C:/Users/daenu/switchdrive/Public/Videos/GitHub/PrimeDeRisque.R')
